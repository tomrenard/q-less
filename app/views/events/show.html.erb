<% content_for :meta_title, "Find all the relevant informations you need before going to this event." %>
<div class="img-container">
  <% if @event.photo.attached? %>
  <div class="show-img">
    <%= cl_image_tag @event.photo.key, height: 300, width: 400, crop: :fit %>
  </div>
  <% else %>
  <div class="seed-img"><img src="<%= @event.photo_link %>" alt="" /></div>
  <% end %>
</div>

<% @very_last_queues.each do |very_last_queue| %>
  <% if very_last_queue.waiting_time < 30 %>
     <div class="card-q">
  <div class="card-q-min text-center">
    <h2><i class="far fa-pause-circle"></i> Queue estimation</h2>
  </div>
  <div class="card-q-infos text-center">
  <h2><%= very_last_queue.waiting_time %>min</h2>
  </div>
</div>
<% elsif very_last_queue.waiting_time > 60 %>
<div class="card-q-l">
  <div class="card-q-min text-center">
    <h2><i class="far fa-pause-circle"></i> Queue estimation</h2>
  </div>
  <div class="card-q-infos text-center">
  <h2><%= very_last_queue.waiting_time %>min</h2>
  </div>
</div>
<% else %>
<div class="card-q-ll">
  <div class="card-q-min text-center">
    <h2><i class="far fa-pause-circle"></i> Queue estimation</h2>
  </div>
  <div class="card-q-infos text-center">
  <h2><%= very_last_queue.waiting_time %>min</h2>
  </div>
</div>
  <% end %>
<% end %>

<!-- <div class="title">
    <h1><%= @event.title %></h1>
</div> -->
<div class="card-i">
  <div class="card-i-l text-center">
    <h2><i class="fas fa-warehouse"></i> <strong> <%= @event.location %> </strong> <br><br>
    <i class="fas fa-map-marker-alt"></i> <%= @event.address %></h2>
  </div>
  <div class="card-i-infos text-center">
    <span><%= @event.start_time.strftime("%a %d") %></span>
  </div>
</div>

<div class="card-line">
  <div class="card-line-l">
    <h2>DJs</h2>
  </div>
  <div class="card-line-infos text-center">
    <span><%= @event.line_up %></span>
  </div>
</div>
<div id="accordion">
  <div class="card-d">
    <div class="card-header" id="headingOne">
      <h5 class="mb-0 text-center">
        <button class="btn desc btn-link text-center" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
          <p class="descripbtn">Click to read the description</p>
        </button>
      </h5>
    </div>

    <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordion">
      <div class="card-body">
      <p><%= @event.description %></p></div>
    </div>
  </div>
  </div>

  <div class="qest text-center">
    <h2>Already in front of the club?</h2>
    <%= link_to new_event_queue_estimation_path(@event,
    @queue_estimation) do %>
    <button type="button" class="queue-btn btn btn-secondary ">Give a estimation of the queue
    </button>
    <% end %>
  </div>
  <br>

  <div id=chatrooomi>
    <h1>
      <%= @chatroom.name %>
    </h1>
    <div id="messages" data-chatroom-id="<%= @chatroom.id %>">
      <% @chatroom.messages.each do |message| %>
      <div class="message-container" id="message-<%= message.id %>">
        <i class="author">
          <span>
            <%= message.user.nickname %></span>
            <small>
              <%= message.created_at.strftime("%a %b %e at %l:%M%p") %></small>
            </i>
            <p>
              <%= message.content %>
            </p>
          </div>
          <% end %>
        </div>
        <%= simple_form_for [ @chatroom, @message ], remote: true do |f| %>
        <%=
        f.input :content, label: false, placeholder: "Let's chat" %>
        <%= hidden_field_tag :authenticity_token, form_authenticity_token %>
        <% end %>
      </div>


<div class=text-center>
  <%= link_to favorite_text.html_safe, event_wishlist_path(event: @event), method: :patch, id: "favorite_link", remote: true %>
  <ul>
    <% @related_events.each do |event| %>
    <li>
      <%= event.title %>
      <% end %>
    </li>
  </ul>
</div>
<div>
<% if current_user.event_wishlists.find {|event_w| event_w.event_id =
  @event.id} %>
  <% else %>
  <% end %>
</div>



    <!-- FOLLOW PART TO IMPLEMENT LATER
 -->    <!-- <div>
  <%# if user_signed_in? && current_user != @user %>
    <%# if current_user.following?(@user) %>
    <%#= button_to  "Unfollow", follow_path(user_id: @user.id), method: :delete, class: 'btn btn-info'%>
    <%# else  %>
    <%#= button_to "Follow", follows_path(user_id: @user.id), class: 'btn btn-primary'%>
    <%# end %>
  <%# end %>
</div> -->


<!-- WAITING PUNDIT CORRECTION
 -->
<!-- <div>
    <%# if policy(Event).destroy? %>
    <p>
      <%#= link_to "Delete my event", event_path(@event), method: :delete, data:
      { confirm: "Are you sure?"}, class: 'btn btn-danger'%>
    </p>
    <%# end %>
    <%# if policy(Event).edit? %>
    <p>
      <%#= link_to "Update my event", edit_event_path(@event), class: 'btn
      btn-info'%>
    </p>
    <#% end %>
  </div> -->


<!-- TO THINK IF WE KEEP IT OR NOT
 -->
<!--   <div class="queue_est text-center">
  <h2>Queue estimation</h2>
  <%# @last_queues.each do |last_queue| %>
  <div class=qest>
    <p>Queue of <strong>
      <%#= last_queue.waiting_time %>min</strong> on
      <%#= last_queue.created_at.strftime("%a %b %e at %l:%M%p")%> indicated by
      <%#= last_queue.user.email %>.</p>
    </div>
    <%# end %>
  </div> -->
